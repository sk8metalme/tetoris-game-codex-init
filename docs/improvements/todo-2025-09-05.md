## 改善タスク（2025-09-05）

優先度: P0 > P1 > P2。各項目は受入条件を明記。

### P0（必須）
1) GameState.rotateCW/CCW 実装（SRS）
   - 条件: T/J/L/S/Z/I/O の回転がSRS簡易に従う。壁蹴り順序の網羅テスト追加。
2) GameState.tick + ロック遅延
   - 条件: gravityPerTick/lockDelayTicks を反映。境界（0/1/N tick）テスト。
3) Score統合
   - 条件: line clear/soft/hard/コンボ/ステージ倍率の加点が`Score`に集約される。スナップショットテスト。
4) Boardの型保持
   - 条件: ロックブロックが型IDで保持され、DTOの`board`に反映。UIの色マッピングが有効化。
5) カバレッジ95%達成
   - 条件: line/branch ≥ 0.95。不足分はGameState/Board/SRSの境界テストで補完。
6) CI導入（GitHub Actions）
   - 条件: `gradle build test lint jacocoTestReport` 実行、しきい値未達でFail。キャッシュ有効化。

### P1（高）
7) Web/API テスト追加
   - 条件: Controller単体で start/input/state の200/400/404/409網羅。JSON shape検証。
8) Idempotency戦略の明文化
   - 条件: start/input のキー保持期限と掃除（LRU or TTL）方針を決定しドキュメント化。
9) UI アクセシビリティ
   - 条件: 高コントラストテーマ、フォーカスリング、凡例表示（色/キー操作）。

### P2（中）
10) SSE/ポーリング最適化
    - 条件: 描画更新手段の検討。負荷測定の簡易結果を記録。
11) 永続化層（将来）
    - 条件: セッション保存/再開の設計メモ作成。

### PR単位の提案（小さく分割）
- PR1: rotate + テスト
- PR2: tick + ロック遅延 + テスト
- PR3: Score統合 + スナップショットテスト
- PR4: Board型保持 + DTO/UI反映 + 回帰テスト
- PR5: CI導入（Actions）+ バッジ
- PR6: Controllerテスト + 例外網羅
- PR7: Idempotency戦略のドキュメント + TTL実装（メモリ）
- PR8: UIアクセシビリティ（凡例/高コントラスト）

