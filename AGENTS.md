# リポジトリガイドライン

## プロジェクト構造とモジュール構成
- Java21 + SpringBoot + Thymeleaf
- オニオンアーキテクチャを採用
- ドキュメント類は、docs配下に配置

## ビルド、テスト、開発コマンド
このリポジトリは意図的にミニマルです。ツールチェーンを導入する際は、コマンドを連携させ、ここに文書化してください：
- `gradle build`: 本番ビルドの作成
- `gradle test`: カバレッジ付きユニットテストの実行
- `gradle lint` : リント

## コーディングスタイルと命名規則
- Google Java Styleに遵守すること


## テストガイドライン
- フレームワーク: JUnit 
- カバレッジ: 文/分岐の95%+を目標


## コミットとプルリクエストガイドライン
- コミット: Conventional Commitsに従う。例: `feat(game): add piece rotation logic`, `fix(ui): correct board rendering`
- PR: 明確な説明、リンクされたissue（例: `Closes #12`）、UI変更のスクリーンショットやGIF、追加/更新されたテストのメモを含める
- サイズ: 小さく焦点を絞ったPRを推奨、合理的な範囲で差分を300行未満に保つ

## セキュリティと設定
- シークレットをコミットしない。`application.properties`や環境変数を使用し、安全なデフォルト設定を提供
- 追加前にアセットライセンスを検証

## Use Language
日本語で簡潔かつ丁寧に回答してください。

## ワークフロー
1. PJ計画 
2. PJ内部レビュー/改善
3. 詳細設計
4. 詳細設計内部レビュー/改善
5. テスト設計
6. テスト設計内部レビュー/改善
7. TDDでの開発
   7-1. テスト開発
   7-2. 開発
   7-3. テスト実施
   7-4. 内部コードレビューの実施
8. ドキュメント最新化
9. 全体の内部レビュー
10. 各種エージェントへの改善指示
11. ghコマンドでPR作成
12. PRを確認してCIが成功しているか確認
13. 進捗確認を実施し次のタスク決定を行う

## 制約
- **ユーザーの停止指示まで自動継続**
- **1 回の実装 = 1 ステップのみ**
- **各エージェント呼び出し前に必ず `docs/context.md` と `docs/plan.md` を読み込む（最新状態を把握）**
- **各実装ステップ後に必ずClaudeにレビュー依頼**
- **レビュー後に必ず次の計画を更新**
- **`docs/context.md` で進捗・コンテキスト管理(UTF-8)**
- **`docs/plan.md` で実行計画管理(UTF-8)**
- **PR作成後、push後はCIが成功するまで確認を継続**

## 進捗確認
実行中の進捗は`docs/context.md`で確認できます。

## Claude Code 連携ガイド

### 目的

ユーザーが 「Claude Codeと相談しながら進めて」 （または類似表現）と指示した場合、
Codex は Claude Code を随時呼び出しながら、複数ターンにわたる協業を行う。

### トリガー
• 正規表現: /Claude.*相談しながら/
• 一度トリガーした後は、ユーザーが明示的に終了を指示するまで 協業モード を維持する。

### 協業ワークフロー (ループ可)

1 PROMPT 準備 最新のユーザー要件 + これまでの議論要約を $PROMPT に格納
2 Claude Code 呼び出し  bash\nclaude <<EOF\n$PROMPT\nEOF\n必要に応じ --max_tokens 等を追加
3 出力貼り付け  Claude Code ➜ セクションに全文、長い場合は要約＋原文リンク
4 Codex コメント  Codex ➜ セクションで Claude Code の提案を分析・統合し、次アクションを提示
5 継続判定  ユーザー入力 or プラン継続で 1〜4 を繰り返す。「Codexコラボ終了」「ひとまずOK」等で通常モード復帰

形式テンプレート

**Claude Code ➜**
<Claude Code からの応答>
**Codex ➜**
<統合コメント & 次アクション>
